\apendice{Documentación de usuario}

\section{Introducción}

En este apartado se explica como puede un usuario prepara el entorno para ejecutar la aplicación y cómo utilizar la aplicación.

\section{Requisitos de usuarios}
\begin{enumerate}
	\item Sistema operativo GNU/Linux
	\item Python 3.6 o superior
	\item Conexión a Internet
\end{enumerate}

\section{Instalación}

\subsection{Ubuntu}

Si ya tienes Ubuntu u otra distribución Linux vete al siguiente apartado.

Para utilizar Ubuntu se va a necesitar algún software de virtualización. En esta guía se va a utilizar VirtualBox, que se puede descargar desde \href{https://www.virtualbox.org/wiki/Downloads}{su página}.
\imagen{descarga_virtualbox}{Descarga de VirtualBox}
Desde su página elegimos la opción de \textbf{Windows hosts} (u otra en función del sistema operativo que se esté utilizando). Esperamos a que se inicie la descarga y ejecutamos el archivo .exe que hemos descargado. Se nos abrirá el instalador y le damos a \textbf{Next, Next, Next, Yes, Install}.

Una vez instalado VirtualBox vamos a descargar Ubuntu. Vamos a \href{https://releases.ubuntu.com/18.04.4/}{su página} y hacemos click en el enlace que pone \textbf{64-bit PC (AMD64) desktop image}. Una vez haya finalizado la descarga abrimos VirtualBox. En la ventana de VirtualBox, hacemos click en \textbf{Nueva} y la configuramos para \textbf{Ubuntu (64-bit)}. A continuación elegimos la cantidad de memoria y creamos un disco virtual de, al menos, 30 GB.

\imagen{VM_crear0}{Nueva máquina virtual} \imagen{VM_crear1}{Tipo de sistema operativo}

Después hacemos click en el apartado de configuración en la ventana inicial de VirtualBox. En la pestaña \textbf{Almacenamiento} hacemos click en \textbf{Añadir una unidad óptica}, que es el botón a la derecha de \textbf{Controlador: IDE}. En la nueva ventana hacemos click en \textbf{Añadir} y seleccionamos el archivo .iso de Ubuntu. En la ventana de configuración también se puede ajustar el número de procesadores y la cantidad de memoria gráfica desde las pestañas \textbf{Sistema} y \textbf{Pantalla} respectivamente. Recomiendo utilizar, como mínimo, 2048MB de memoria RAM, 2 núcleos de procesador y 128MB de memoria de vídeo.

\imagen{VM_config0}{Configuración de máquina virtual} \imagen{VM_config1}{Parámetros de configuración}

Una vez terminada la configuración, iniciamos Ubuntu desde la ventana principal de VirtualBox con el botón \textbf{Iniciar}. En la primera pantalla de Ubuntu seleccionamos el idioma (español) y le damos a instalar Ubuntu.
Después seleccionamos el idioma del teclado y la instalación de Ubuntu, en nuestro caso es suficiente con la \textbf{instalación mínima}. A continuación borramos el disco virtual, seleccionamos la franja horaria y completamos los campos que nos pide. Una vez termine de instalar nos pedirá reiniciar y después darle al \textbf{Enter}. Cuando se haya iniciado Ubuntu solo queda instalar las \textbf{guest additions}, que es totalmente opcional pero aumenta el rendimiento. Para instalarlas hacer click en la pestaña \textbf{Dispositivos} y \textbf{Insertar imagen de CD de las <<Guest Additions>>...} y reiniciar el sistema operativo.

\imagen{Ubuntu_install}{Instalación de Ubuntu} \imagen{Ubuntu_install2}{Instalación de Ubuntu}

\subsection{Python3 y sus dependencias}

Python3 viene instalado por defecto en Ubuntu 18.04. Para instalar las dependencias necesitamos pip3, que se instala con el comando \textbf{sudo apt install python3-pip}. Ahora las dependencias que necesitamos se instalan mediante los comandos \textbf{sudo apt-get install python3-pyqt5} y \textbf{pip3 install mycroft-messagebus-client}

\subsection{Mycroft}
Antes de nada, necesitamos tener git instalado, se instala mediante el comando \textbf{sudo apt install git}, y necesitamos una cuenta de Mycroft, para ello ir a \href{https://mycroft.ai/}{su página} y crearla.

\imagen{crear_mycroft1}{Creación de cuenta de Mycroft} \imagen{crear_mycroft2}{Creación de cuenta de Mycroft}

Para instalar Mycroft hay que seguir los pasos en la sección \textbf{Getting Started} de la guía que hay en \href{https://github.com/MycroftAI/mycroft-core}{su repositorio}, que son:
\begin{enumerate}
	\item \textbf{cd \detokenize{~}}
	\item \textbf{git clone https://github.com/MycroftAI/mycroft-core.git}
	\item \textbf{cd mycroft-core}
	\item \textbf{bash dev\_setup.sh}
\end{enumerate}

Tras introducir el comando \textbf{bash dev\_setup.sh} se nos abrirá el proceso de instalación interactiva. Le vamos a dar a todo a \textit{Yes} (escribir la letra Y en la consola) 

Una vez instalado, continuar a la sección \textbf{Running Mycroft} de \href{https://github.com/MycroftAI/mycroft-core}{su repositorio} para ejecutarlo, mediante el los comandos:
\begin{enumerate}
	\item \textbf{cd \detokenize{~}/mycroft-core}
	\item \textbf{./start-mycroft.sh debug}
\end{enumerate}

Tras iniciar Mycroft tenemos que decir por voz cualquier cosa para que se inicie el proceso de enlazamiento. La aplicación nos dirá un código (si se ha iniciado con la opción de \textit{debug} también aparecerá en pantalla). Este código hay que ponerlo al añadir un nuevo dispositivo. En \href{https://home.mycroft.ai}{la página de Mycroft} en la esquina superior derecha, en la sección de \textbf{Devices}, \textbf{Add Device} en el apartado de \textbf{Pairing code}. Al añadir el nuevo dispositivo es importante que en el apartado \textbf{Voice} se seleccione \textbf{Google Voice}.

Para parar Mycroft si se ha iniciado con la opción de \textit{debug} se puede presionar la combinación de teclas \textbf{ctrl + c} o escribir en la interfaz \textbf{:exit}

\imagen{cuenta_mycroft}{Crear dispositivo en Mycroft}

\section{Manual del usuario}

\textbf{IMPORTANTE: En varios comandos van a aparecer expresiones como 1.X La X indica la versión de la aplicación y hay que cambiarla por el número correspondiente.}

En Ubuntu, para ejecutar la aplicación hay que descargar el \href{https://github.com/adp1002/UBUAssistant/releases}{proyecto de GitHub} (el archivo \textbf{Source code (tar.gz)}) y  descomprimirlo en la carpeta personal.

\imagen{release}{Descarga de la release del proyecto}

Cuando tengamos el proyecto descargado, mover el contenido de la carpeta \textbf{\detokenize{~}/src/skills/} a \textbf{/opt/mycroft/skills/}, ejecutando el comando:
\textbf{sudo mv \detokenize{~}/UBUAssistant-1.X/src/skills/* /opt/mycroft/skills/})

Nos vamos a la carpeta \textbf{/src/} del proyecto y ejecutamos la aplicación mediante los comandos:
\begin{enumerate}
	\item \textbf{cd \detokenize{~}/UBUAssistant-1.X/src}
	\item \textbf{python3 -m GUI.main >\null> logs.log}
\end{enumerate}
Se nos abrirá la ventana de inicio de sesión. En esta ventana se introducirán los credenciales del usuario para la plataforma de Moodle a la que se quiera conectar, así como la URL de esta plataforma.
Es importante que en el campo \textbf{host} se introduzca la URL exactamente con el formato que viene indicado. Por ejemplo, para conectarse a UBUVirtual la URL que habrá que introducir es, literalmente, \textbf{https://ubuvirtual.ubu.es}.
También se puede cambiar el idioma de la aplicación en la esquina superior derecha y recordar el usuario y host para futuras ejecuciones.

\imagen{login_window}{Ventana de inicio de sesión}

En la parte superior de la ventana principal de la aplicación se muestra la estructura de todos los \textit{intents}. El botón del micrófono sirve para alternar entre activar y desactivarlo, cuando el botón está verde está activo y cuando está rojo está inactivo.
Para usar la aplicación mediante voz, hay que decir la \textit{wake word} (por defecto es "Hey Mycroft") y se escuchará un sonido si ha detectado la \textit{wake word}. Después de escuchar el sonido se puede preguntar lo que queramos con la frase correspondiente. Para utilizar la conversación mediante texto hay que escribir la pregunta, sin la \textit{wake word}, y darle a enviar. Toda la conversación, ya sea mediante texto o voz, será transcrita en la ventana.

\imagen{main_window}{Ventana principal} \imagen{ejemplo_skill}{Ejemplo de salida de la aplicación}

Se pueden tener activas las \textit{skills} que queramos, haciendo click en el botón de \textbf{Administrar Skills}. Las \textit{skills} que están marcadas son las activas. Para activar o desactivar una \textit{skill}, marcar o desmarcar las \textit{skills} que queramos y pulsar el botón \textbf{Guardar}

\imagen{skills_window}{Ventana de administración de las \textit{Skills}}

Con el botón de \textbf{Abrir Logs} podemos ver los distintos mensajes de información que se van guardando durante la ejecución de la aplicación. Los títulos de las pestañas hacen referencia al fichero de log que se muestra en esa pestaña.

\imagen{log_window}{Visualización de logs}